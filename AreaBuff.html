<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <base href="/Icons/General/">
  <title>ã‚¨ãƒªã‚¢ã®ãƒãƒ• (ã‚³ã‚¤ãƒ³ãƒ»ãƒ‰ãƒ­ãƒƒãƒ—)</title>
  <style>
    #countdown {
      text-align: right;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }
    td {
      height: 36px;
      border: 1px solid #333;
      text-align: center;
      vertical-align: middle;
      font-size: 24px;
    }
    .label {
      width: 100px;
      font-size: 18px;
	  padding: 0 2px;
      font-weight: bold;
      background: #eee;
	  white-space: nowrap;
    }
	.title {
      height: 12px;
      font-size: 12px;
    }
	.buff_icon {
		height:24px; 
		vertical-align: middle;
	}
  </style>
</head>
<body>

<div id="countdown"></div>
<table id="mainTable"></table>

<script>
  const baseUnix = 1349017200 * 1000;
  const interval = 40;
  const groupSpacing = 280;
  const groupCount = 21;
  const symbolA = `<img src="ic_up_coin01.png" class="buff_icon" onerror="this.replaceWith(document.createTextNode('ğŸ’°'))">`;
  const symbolB = `<img src="ic_up_drop01.png"class="buff_icon" onerror="this.replaceWith(document.createTextNode('ğŸ“¦'))">`;
  const symbolBOffset = 4;
  
  const names = [
  "Area",
  "ãƒ‰ãƒ¼ãƒŠãƒ„è‰åŸ", 
  "ãƒ©ãƒ ãƒæµ·å²¸", 
  "ã‚·ãƒ£ãƒ¼ãƒ™ãƒƒãƒˆæ´çªŸ", 
  "ãŠã—ã‚‹ã“æ°·æ²³", 
  "ã‚ãŸã‚ã‚é›²æµ·",
  "ãƒã‚·ãƒ¥ãƒãƒ­å®®æ®¿", 
  "ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆç«å±±", 
  "ãƒ¡ãƒ­ãƒ³ç ‚æ¼ ", 
  "ãƒãƒŠãƒŠã‚¯ãƒ¬ãƒ¼ãƒ—å¯†æ—", 
  "ã‚³ãƒ³ãƒšã‚¤ãƒˆã‚¦éºè·¡",
  "ãƒãƒãƒ­ã‚¢é­”åŸ", 
  "ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ åº­åœ’", 
  "ãƒãƒ¥ãƒ­ã‚¹éŠåœ’åœ°", 
  "ã¿ãŸã‚‰ã—åŸéƒ­", 
  "ãã³ã ã‚“ã”å­¤å³¶",
  "ã‚«ã‚¹ãƒ†ãƒ¼ãƒ©åŸéƒ­éƒ½å¸‚", 
  "ãƒ¡ã‚¤ãƒ—ãƒ«ã‚­ãƒ³ã‚°ãƒ€ãƒ ", 
  "ãƒ¡ã‚¤ãƒ—ãƒ«ãƒ‰ãƒƒã‚¯", 
  "ç‹éƒ½ã‚¬ãƒ¬ãƒƒãƒˆãƒ»ãƒ‡ãƒ»ãƒ­ãƒ¯", 
  "ãƒŸãƒ«ãƒ•ã‚£ãƒ¼ãƒ¦å¤§æ¨¹",
  "ãƒ¡ãƒ¬ãƒ³ã‚²ç¾¤å³¶"
];

  const now = Date.now();
  const table = document.getElementById("mainTable");

  for (let i = 0; i < groupCount+1; i++) {
    const row = document.createElement("tr");

    if  (i === 0) {
		for (let j = 0; j < 8; j++) {
		  const cell = document.createElement("td");
		  cell.className = "title";
		  cell.textContent =  (j > 0) ? "S" + j : names[i];
		  row.appendChild(cell);
		}
	} else {
		const labelCell = document.createElement("td");
		labelCell.className = "label";
		labelCell.textContent =names[i];
		row.appendChild(labelCell);
		
		const cells = [];
		for (let j = 0; j < 7; j++) {
		  const cell = document.createElement("td");
		  cells.push(cell);
		  row.appendChild(cell);
		}

		const groupStart = baseUnix + (i-1) * groupSpacing * 60 * 1000;
		const diffMinutes = (now - groupStart) / (1000 * 60);
		const moveSteps = Math.floor((diffMinutes - 0.000001) / interval);
		const posA = moveSteps % 8;
		const posB = (posA + symbolBOffset) % 8;

		if (posA < 7) cells[posA].innerHTML  = symbolA;
		if (posB < 7) cells[posB].innerHTML  = symbolB;
	}

    table.appendChild(row);
  }

  const countdownEl = document.getElementById("countdown");
  // é¡¯ç¤ºé‚„æœ‰å¹¾åˆ†é˜æ›ä¸‹ä¸€æ ¼
  //const minutesSinceLast = Math.floor((now - baseUnix) / (1000 * 60)) % interval;
  //const remaining = interval - minutesSinceLast;
  //countdownEl.textContent = `ä¸‹æ¬¡è®Šå‹•ï¼š ${remaining} åˆ†é˜`;
  // é¡¯ç¤ºä»€éº¼æ™‚å€™æ›ä¸‹ä¸€æ ¼
  const nextUpdate = new Date(baseUnix + Math.ceil((now - baseUnix) / (interval * 60 * 1000)) * interval * 60 * 1000);
  countdownEl.textContent = `æ¬¡ã®å¤‰æ›´ï¼š ${nextUpdate.toLocaleString('ja-JP', { hour12: false })}`;

</script>

</body>
</html>
